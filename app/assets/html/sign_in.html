<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap core CSS -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB"
    crossorigin="anonymous">
  <link href="/css/the-host.css" rel="stylesheet">
  <link href="/css/components.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="/css/sign_in.css" rel="stylesheet">

  <title>Sign in</title>
</head>

<body class="bg-light">
  <div id="nav-bar-container"></div>

  <!-- here render the login form -->
  <div id="signin-form-container"></div>

  <footer class="my-5 pt-5 text-muted text-center text-small">
    <p class="mb-1">&copy; Event Planning Inc, 2018</p>
  </footer>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
    crossorigin="anonymous"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-transition-group@2.3.1/dist/react-transition-group.min.js"></script>
  <script type="text/babel" src="/js/common.js"></script>
  <script type="text/babel" src="/js/ui/Banner.js"></script>
  <script type="text/babel" src="/js/ui/Avatar.js"></script>
  <script type="text/babel" src="/js/ui/NavBar.js"></script>
  <script type="text/babel" src="/js/ui/LoginForm.js"></script>

  <script type="text/babel">
    // babel (js for React) goes here

    ReactDOM.render(
      <NavBar curPath="/html/sign_in.html" />,
      document.getElementById('nav-bar-container')
    );

    if (getCurUser()) {
      // already logged in
      window.location = '/html/home.html';
    }

    class App extends React.Component {
      constructor(props) {
        super(props);
        this.addNotification = this.addNotification.bind(this);
        this.removeNotification = this.removeNotification.bind(this);

        this.state = {
          entries: [],
          addNotification: this.addNotification,
          removeNotification: this.removeNotification
        }
      }

      addNotification(entry) {
        this.setState(({ entries, ...others }) => ({
          entries: [...entries, entry],
          ...others
        }));
      }

      removeNotification(entryId) {
        this.setState(({ entries, ...others }) => {
          let i = entries.map(e => e.id).indexOf(entryId);
          if (i === -1) { return { entries, ...others }; }
          
          // return the next state
          return {
            entries: [...entries.slice(0, i), ...entries.slice(i + 1)],
            ...others
          };
        });
      }

      render() {
        return (
          <NotificationContext.Provider value={this.state}>
            <BannerList />

            {/* put your react component tree root here */}
            {/* inside it, you can use the notification utility via `withNotifications` */}
            <LoginForm />
          </NotificationContext.Provider>
        );
      }
    }

    ReactDOM.render(
      <App />, 
      document.getElementById('signin-form-container')
    );

  </script>
</body>

</html>
